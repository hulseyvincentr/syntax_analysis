import pandas as pdfrom pathlib import Pathdef load_compact_metadata(    excel_path,    sheet_name=0,    id_col="Animal ID",):    """    Read an Excel sheet and build a compact metadata dict per Animal ID.    For each Animal ID:      - Columns that have a single unique value for that animal are stored once        (e.g. Treatment date, Treatment type, etc.).      - Remaining columns are stored in a list of dicts under 'injections'.    Returns    -------    metadata : dict        {          "USA5288": {              "Animal ID": "USA5288",              "Treatment date": ...,              "Treatment type": ...,              ... (other constant columns),              "injections": [                  {"Injection #": 1, "AP (mm)": 5.6, "ML (mm)": 1.6, ...},                  {"Injection #": 2, "AP (mm)": 5.61, "ML (mm)": 1.4, ...},                  ...              ]          },          ...        }    """    excel_path = Path(excel_path)    df = pd.read_excel(excel_path, sheet_name=sheet_name)    metadata = {}    for animal_id, group in df.groupby(id_col):        # Figure out which columns are constant within this animal        constant_cols = {}        for col in group.columns:            if col == id_col:                continue            unique_vals = group[col].dropna().unique()            if len(unique_vals) == 1:                constant_cols[col] = unique_vals[0]        # Columns that vary across rows â†’ keep per injection        injection_cols = [            col for col in group.columns            if col not in constant_cols and col != id_col        ]        injections = group[injection_cols].to_dict(orient="records")        # Build the per-animal entry        entry = {id_col: animal_id, **constant_cols, "injections": injections}        metadata[animal_id] = entry    return metadata# ---- Example usage ----from Area_X_meta_wrapper import load_compact_metadataexcel_file = "/Users/mirandahulsey-vincent/Desktop/Area_X_one_sheet_template.xlsx"metadata = load_compact_metadata(excel_file)# What animals do we have?print(metadata.keys())# Look at one animal's metadatafrom pprint import pprintpprint(metadata["USA5288"])